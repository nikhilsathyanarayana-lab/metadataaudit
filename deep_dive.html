<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Metadata Deep Dive</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="exports.css">
</head>
<body>
  <nav class="global-nav" aria-label="Primary">
    <div class="nav-inner">
      <div class="nav-links">
        <a class="nav-link" href="index.html" aria-current="page">Integration API</a>
        <a class="nav-link" href="cookie_method.html">Cookie</a>
      </div>
      <label class="debug-toggle" for="debug-toggle">
        <span class="debug-toggle-text">Debug</span>
        <span class="debug-toggle-control">
          <input
            type="checkbox"
            id="debug-toggle"
            aria-label="Toggle deep dive debug logging"
          />
          <span class="debug-toggle-slider" aria-hidden="true"></span>
        </span>
        <span class="debug-toggle-status" id="debug-toggle-status">Off</span>
      </label>
    </div>
  </nav>
  <div class="status-banner" id="deep-dive-progress" role="status" aria-live="polite" aria-atomic="false">
    <span id="deep-dive-api-progress" aria-live="polite">API calls not started.</span>
    <span id="deep-dive-processing-progress" aria-live="polite">Processing not started.</span>
  </div>
  <header class="page-header" id="metadata-deep-dive-header">
    <div class="header-row" id="metadata-deep-dive-header-row">
      <div class="header-copy" id="metadata-deep-dive-header-copy">
        <h1 class="page-title" id="metadata-deep-dive-title">Metadata Deep Dive</h1>
        <p class="section-hint" id="metadata-deep-dive-hint">Explore retention counts with expected format details for every field.</p>
      </div>
      <div class="header-actions" id="metadata-deep-dive-actions" aria-label="Metadata actions">
        <button type="button" class="tertiary-btn" id="deep-dive-start">Start scan</button>
        <button type="button" class="primary-btn" id="export-button" disabled aria-disabled="true">Export</button>
      </div>
    </div>
  </header>

  <main class="content" id="metadata-deep-dive-main" aria-labelledby="metadata-deep-dive-title">
    <section class="card" id="visitor-deep-dive-card" aria-label="Visitor metadata deep dive table">
      <div class="card-header" id="visitor-deep-dive-card-header">
        <div class="form-intro" id="visitor-deep-dive-form-intro">
          <h2 class="section-title" id="visitor-deep-dive-section-title">Visitor</h2>
          <p class="section-hint" id="visitor-deep-dive-section-hint"></p>
        </div>
        <div class="lookback-controls" id="deep-dive-lookback-controls" role="group" aria-label="Select metadata window">
          <span class="lookback-label">Window:</span>
          <div class="lookback-buttons">
            <button type="button" class="lookback-button tertiary-btn" data-lookback-button data-lookback="7">7 days</button>
            <button type="button" class="lookback-button tertiary-btn" data-lookback-button data-lookback="30">30 days</button>
            <button type="button" class="lookback-button tertiary-btn" data-lookback-button data-lookback="180">180 days</button>
          </div>
        </div>
      </div>

      <div class="table-wrapper" id="visitor-deep-dive-table-wrapper" role="region" aria-label="Visitor metadata deep dive table wrapper" tabindex="0">
        <table class="data-table" id="visitor-deep-dive-table">
          <thead>
            <tr>
              <th scope="col">Sub ID</th>
              <th scope="col">App Name</th>
              <th scope="col">App ID</th>
              <th scope="col" class="metadata-field-header">Metadata field (7 days)</th>
              <th scope="col">Expected format</th>
            </tr>
          </thead>
          <tbody id="visitor-deep-dive-table-body"></tbody>
        </table>
      </div>

      <div class="metadata-tree-container" id="visitor-metadata-tree-container" aria-label="Visitor metadata value overview" role="region" tabindex="0">
        <div class="form-intro" id="visitor-metadata-tree-intro">
          <h3 class="section-title" id="visitor-metadata-tree-title">Visitor metadata values</h3>
          <p class="section-hint" id="visitor-metadata-tree-hint">See how often each value appeared for every visitor across Sub IDs and apps.</p>
        </div>
        <div id="visitor-metadata-tree" class="metadata-tree" aria-live="polite"></div>
      </div>
    </section>

    <section class="card" id="account-deep-dive-card" aria-label="Account metadata deep dive table">
      <div class="card-header" id="account-deep-dive-card-header">
        <div class="form-intro" id="account-deep-dive-form-intro">
          <h2 class="section-title" id="account-deep-dive-section-title">Account</h2>
          <p class="section-hint" id="account-deep-dive-section-hint">Retention counts for account metadata using the same tracking windows.</p>
        </div>
      </div>

      <div class="table-wrapper" id="account-deep-dive-table-wrapper" role="region" aria-label="Account metadata deep dive table wrapper" tabindex="0">
        <table class="data-table" id="account-deep-dive-table">
          <thead>
            <tr>
              <th scope="col">Sub ID</th>
              <th scope="col">App Name</th>
              <th scope="col">App ID</th>
              <th scope="col" class="metadata-field-header">Metadata field (7 days)</th>
              <th scope="col">Expected format</th>
            </tr>
          </thead>
          <tbody id="account-deep-dive-table-body"></tbody>
        </table>
      </div>
    </section>
  </main>
  <script type="module" src="src/entries/deep_dive.js"></script>
</body>
</html>
